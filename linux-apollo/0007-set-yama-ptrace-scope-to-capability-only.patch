From cf33be92dc8d5ec64bba2419d540989ca13a843d Mon Sep 17 00:00:00 2001
From: Rithvik Ballari <nexus-x@tuta.io>
Date: Fri, 14 Nov 2025 21:28:46 +0530
Subject: [PATCH 7/9] Set yama ptrace scope to capability

Signed-off-by: Rithvik Ballari <nexus-x@tuta.io>
---
 security/yama/yama_lsm.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/security/yama/yama_lsm.c b/security/yama/yama_lsm.c
index e1a5e13ea..913fa643f 100644
--- a/security/yama/yama_lsm.c
+++ b/security/yama/yama_lsm.c
@@ -25,7 +25,7 @@
 #define YAMA_SCOPE_CAPABILITY	2
 #define YAMA_SCOPE_NO_ATTACH	3
 
-static int ptrace_scope = YAMA_SCOPE_RELATIONAL;
+static int ptrace_scope = YAMA_SCOPE_CAPABILITY;
 
 /* describe a ptrace relationship for potential exception */
 struct ptrace_relation {
-- 
2.51.2

